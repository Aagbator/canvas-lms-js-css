<!DOCTYPE html>
<html>
<head>
<script>
	var bzBoxTypes = [
		{ className: "", defaultTitle: ""},
		{ className: "question", defaultTitle: "Quick Question" },
		{ className: "answer", defaultTitle: "Answer" },
		{ className: "video", defaultTitle: "Watch This" },
		{ className: "read", defaultTitle: "Story Time" },
		{ className: "reflection", defaultTitle: "Get to know yourself" },
		{ className: "action", defaultTitle: "Take a real step right now" },
		{ className: "pulse", defaultTitle: "Pulse Check" },
	];

	var htmlBefore = "";
	var htmlAfter = "";
</script>
<!--
	Keyboard controls: FIXME: what about Macs????

	Special ones
	============
	`Shift+Delete` 	- delete entire current html tag for current cursor
	`Esc` 		- switch between rendered and source views
	`alt+<` 	- open a html insertion window
	`Enter` 	- new line (context dependent)
	`Shift+Enter` 	- insert <br> at current location
	`Ctrl+Enter` 	- Move cursor outside current html tag

	Ones your probably know
	=======================

	`Ctrl+b` 	- toggle bold on and off
	`Ctrl+i` 	- toggle italic on and off

	`Ctrl+x` 	- cut
	`Ctrl+c` 	- copy
	`Ctrl+v` 	- paste

	// not implemented
	`Ctrl+a` 	- select all INSIDE the current parent (so NOT all of the whole document!)
	`Ctrl+s` 	- save
	`Ctrl+z` 	- undo
-->

	<link rel="stylesheet" href="bz_newui.css" />
	<base href="https://stagingportal.bebraven.org/" target="_blank" />
	<meta charset="UTF-8" />

	<title>Braven Editor</title>

	<style id="embedded-css"></style>
	<script id="embedded-js"></script>
</head>
<body>
	<div id="toolarea">
		<div style="border-bottom: solid 1px black;">
			<!-- New -->
			<button type="button" onclick="
				var n = prompt('id');
				if(n !== null)
					load(n);
			">Open</button>
			<button type="button" onclick="
				var node = document.getElementById('editor').cloneNode(true);
				unwrapStuffForEditing(node);
				EditorApi.save(currentlyLoaded.id, node.innerHTML).
					get(function(id) {
						currentlyLoaded.branchPoint = currentlyLoaded.id;
						currentlyLoaded.id = id;

						history.pushState(null, null, EditorApi._apiBase + 'edit?id=' + id);
					});
			">Save</button>
			<button type="button" onclick="
				var node = document.getElementById('editor').cloneNode(true);
				unwrapStuffForEditing(node);
				var tag = prompt('Tag');
				if(tag !== null)
				EditorApi.save(currentlyLoaded.branchPoint, node.innerHTML, tag).
					get(function(id) {
						currentlyLoaded.id = id;
						currentlyLoaded.branchPoint = id;
					});
			">Save As</button>
			<button type="button" onclick="
				var element = document.createElement('a');
				element.setAttribute('download', 'module.html');
				element.setAttribute('href', 'data:text/html;charset=utf-8,' + encodeURIComponent(
					htmlBefore + document.getElementById('editor').innerHTML + htmlAfter
				));
				element.style.display = 'none';
				document.body.appendChild(element);
				element.click();
				document.body.removeChild(element);
			">Download</button>

			<button type="button" onclick="
				var element = document.createElement('a');
				element.setAttribute('target', '_blank');
				element.setAttribute('href', 'data:text/html;charset=utf-8,' + encodeURIComponent(
					htmlBefore + document.getElementById('editor').innerHTML + htmlAfter
				));
				element.style.display = 'none';
				document.body.appendChild(element);
				element.click();
				document.body.removeChild(element);
			">Preview</button>



			Push to Staging
			Push to Production
		</div>

		<div style="float: right;">
			<button type="button" onclick="listMagicFields();">List Magic Fields</button>
			<button type="button" onclick="listHeaders();">List Headers</button>
		</div>

		<select id="block-format" onchange="
			document.execCommand('formatBlock', false, this.options[this.selectedIndex].value);
		">
			<option value="">--Block Format--</option>
			<option value="h2">Heading 2</option>
			<option value="h3">Heading 3</option>
			<option value="h4">Heading 4</option>
			<option value="h5">Heading 5</option>
			<option value="h6">Heading 6</option>
		</select>

		<br />

		<button type="button" onclick="insertBox();">Insert Box</button>

		<button type="button" onclick="document.execCommand('undo');">Undo</button>
	</div>

	<div id="sidebar"></div>

	<div id="tree-position"></div>

	<div id="view-source"> <textarea></textarea> </div>

	<div id="editor" class="user_content show-answers" contenteditable="true"></div>

	<!--
	// fucking jquery required
	<script src="bz_custom.js"></script>
	-->
</body>
</html>
